app = "slurpy-web"
primary_region = "iad"

[build]
  dockerfile = "infra/docker/Dockerfile.frontend"
  context = "."

  [build.args]
    NEXT_PUBLIC_RAG_API = "https://api.slurpy.life/v1/mcp/stream"
    NEXT_TELEMETRY_DISABLED = "1"
    NEXT_PUBLIC_SUPABASE_URL = "https://cmykvjwkhtxhlsijlqxb.supabase.co"
    NEXT_PUBLIC_SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNteWt2andraHR4aGxzaWpscXhiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM1NjQ1MDQsImV4cCI6MjA2OTE0MDUwNH0.gSxeYjaU96VL6J2-nz-jNvOg1pCD18d0ImLr0K9GwxU"

[env]

  # Public API base for client streaming
  NEXT_PUBLIC_RAG_API = "https://api.slurpy.life/v1/mcp/stream"

  # Backend base URL for server-to-server calls from API routes
  # This should point to the actual backend FastAPI service, not the MCP
  BACKEND_URL = "https://slurpy.fly.dev"

  # Runtime Node options
  NODE_OPTIONS = "--dns-result-order=ipv4first"

  # Note: Provide Supabase public envs at build time via environment/secrets
  # - NEXT_PUBLIC_SUPABASE_URL
  # - NEXT_PUBLIC_SUPABASE_ANON_KEY

[http_service]
  internal_port = 3000
  force_https = true
  auto_stop_machines = true
  auto_start_machines = true
  min_machines_running = 0

[[vm]]
  cpu_kind = "shared"
  cpus = 1
  memory = "1gb"
